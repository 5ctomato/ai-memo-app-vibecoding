# Story 1.5: 신규 사용자 온보딩 플로우

## Status
Draft

## Story
**As a** 신규 사용자,
**I want** 회원가입 후 앱의 주요 기능을 안내받을 수 있도록,
**so that** 앱을 효과적으로 사용할 수 있다

## Acceptance Criteria
1. 회원가입 완료 후 온보딩 페이지로 자동 리다이렉트
2. 앱의 주요 기능 소개 (음성 메모, AI 요약, 태깅, 검색)
3. 단계별 온보딩 가이드 (최대 3단계)
4. 각 단계에서 "다음" 및 "건너뛰기" 옵션 제공
5. 온보딩 완료 후 메인 대시보드로 이동
6. 온보딩 중단 시에도 나중에 다시 볼 수 있는 옵션
7. 모바일 친화적인 온보딩 UI
8. 온보딩 완료 상태를 사용자 프로필에 저장

## Tasks / Subtasks
- [ ] 온보딩 페이지 구조 설계 (AC: 1, 2, 3)
  - [ ] 온보딩 레이아웃 컴포넌트 생성
  - [ ] 단계별 진행 표시기 구현
  - [ ] 반응형 디자인 적용 (모바일 우선)
- [ ] 온보딩 콘텐츠 구현 (AC: 2, 3)
  - [ ] 주요 기능 소개 슬라이드 3개 생성
  - [ ] 각 슬라이드별 설명 텍스트 및 이미지/아이콘
  - [ ] 한국어 콘텐츠 작성
- [ ] 온보딩 네비게이션 구현 (AC: 4, 5)
  - [ ] "다음", "이전", "건너뛰기" 버튼 구현
  - [ ] 마지막 단계에서 "시작하기" 버튼
  - [ ] 온보딩 완료 후 대시보드 리다이렉트
- [ ] 온보딩 상태 관리 (AC: 6, 8)
  - [ ] 사용자 온보딩 완료 상태 저장 (Supabase)
  - [ ] 온보딩 재시작 기능 구현
  - [ ] 헤더에 온보딩 재시작 링크 추가
- [ ] 회원가입 플로우 통합 (AC: 1)
  - [ ] 회원가입 완료 후 온보딩 페이지로 리다이렉트
  - [ ] 기존 사용자는 온보딩 건너뛰기
- [ ] 테스트 작성
  - [ ] 온보딩 페이지 렌더링 테스트
  - [ ] 네비게이션 기능 테스트
  - [ ] 상태 저장 및 복원 테스트
  - [ ] 반응형 디자인 테스트

## Dev Notes

### 기술 스택 정보
[Source: architecture.md#1]
- **프레임워크:** Next.js (App Router, Server Actions)
- **UI:** shadcn/ui + Tailwind + Radix UI
- **DB/인증:** Supabase (Postgres, Auth, Storage)
- **ORM:** Drizzle ORM

### 이전 스토리 인사이트
[Source: 1.1.story.md, 1.2.story.md, 1.3.story.md, 1.4.story.md]
- 회원가입 완료 후 리다이렉트 로직이 이미 구현됨 (`SignupForm.tsx`)
- useAuth 훅을 통한 사용자 상태 관리 구현됨
- shadcn/ui 컴포넌트 시스템 구축됨
- 한국어 UI/UX 패턴 확립됨

### 데이터 모델
[Source: architecture.md#2]
- 기존 notes, note_tags, summaries 테이블 외에 사용자 온보딩 상태 저장 필요
- 사용자 프로필에 onboarding_completed 필드 추가 고려
- 또는 별도 user_onboarding 테이블 생성

### API 명세
[Source: Supabase Auth Documentation]
- 사용자 프로필 업데이트: `supabase.auth.updateUser()`
- 사용자 메타데이터 저장: `supabase.auth.updateUser({ data: { onboarding_completed: true } })`
- 또는 별도 테이블에 온보딩 상태 저장

### 컴포넌트 명세
- **온보딩 페이지**: `app/onboarding/page.tsx`
- **온보딩 슬라이드**: `components/onboarding/OnboardingSlide.tsx`
- **진행 표시기**: `components/onboarding/ProgressIndicator.tsx`
- **온보딩 레이아웃**: `components/onboarding/OnboardingLayout.tsx`

### 파일 위치
[Source: architecture.md#1]
- **페이지**: `app/onboarding/page.tsx`
- **컴포넌트**: `components/onboarding/`
- **테스트**: `__tests__/onboarding/`
- **타입**: `types/onboarding.ts`

### 온보딩 콘텐츠 구조
1. **슬라이드 1**: 음성 메모 기능 소개
   - 음성으로 빠르게 메모 작성
   - 실시간 음성-텍스트 변환
2. **슬라이드 2**: AI 자동 요약 및 태깅
   - 3-6 불릿 요약 자동 생성
   - 최대 6개 태그 자동 추출
3. **슬라이드 3**: 검색 및 필터링
   - 태그 기반 검색
   - 제목/본문 통합 검색

### 상태 관리
- 온보딩 진행 상태: React useState
- 현재 단계: 0, 1, 2 (3단계)
- 완료 상태: Supabase 사용자 메타데이터에 저장

### 라우팅 전략
- 회원가입 완료 → `/onboarding` 리다이렉트
- 온보딩 완료 → `/dashboard` 또는 `/` 리다이렉트
- 기존 사용자 → 온보딩 건너뛰기

### 테스트 요구사항
[Source: Jest + React Testing Library]
- 온보딩 페이지 렌더링 테스트
- 슬라이드 네비게이션 테스트
- 상태 저장 및 복원 테스트
- 반응형 디자인 테스트 (모바일/데스크톱)
- Supabase 연동 모킹

### 보안 고려사항
[Source: architecture.md#3]
- 온보딩 상태는 사용자 스코프로만 접근 가능
- RLS 정책 적용 (사용자 자신의 온보딩 상태만 조회/수정)

## Testing

### 테스트 파일 위치
- `__tests__/onboarding/onboarding.test.tsx`
- `__tests__/onboarding/OnboardingSlide.test.tsx`
- `__tests__/onboarding/ProgressIndicator.test.tsx`

### 테스트 표준
- Jest + React Testing Library 사용
- Supabase 함수 모킹
- 사용자 상호작용 시뮬레이션 (fireEvent)
- 비동기 작업 처리 (waitFor)

### 테스트 케이스
1. **온보딩 페이지 렌더링 테스트**
   - 3개 슬라이드가 순서대로 표시되는지 확인
   - 진행 표시기가 올바르게 표시되는지 확인
2. **네비게이션 기능 테스트**
   - "다음" 버튼으로 슬라이드 이동
   - "이전" 버튼으로 슬라이드 이동
   - "건너뛰기" 버튼으로 온보딩 종료
3. **상태 저장 테스트**
   - 온보딩 완료 시 사용자 상태 업데이트
   - 온보딩 재시작 기능
4. **반응형 디자인 테스트**
   - 모바일/데스크톱 화면에서 올바른 레이아웃
   - 터치 제스처 지원 (모바일)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-10-13 | 1.0 | 초기 스토리 생성 | Bob (SM) |

## Dev Agent Record
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

## QA Results
*이 섹션은 QA 에이전트가 검토 후 채워집니다*









