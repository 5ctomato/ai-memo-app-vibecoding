# Story 2.6: 노트 정렬 옵션 (최신순, 제목순)

## Status
Draft

## Story
**As a** 사용자,
**I want** 노트 목록을 다양한 기준으로 정렬할 수 있도록,
**so that** 원하는 방식으로 노트를 탐색하고 관리할 수 있다

## Acceptance Criteria

1. **정렬 옵션 제공**
   - 최신순 (수정일시 기준 내림차순)
   - 오래된순 (수정일시 기준 오름차순)
   - 제목 오름차순 (A-Z)
   - 제목 내림차순 (Z-A)
   - 생성일시 최신순
   - 생성일시 오래된순

2. **정렬 UI**
   - 드롭다운 메뉴로 정렬 옵션 선택
   - 현재 정렬 기준 시각적 표시
   - 정렬 방향 아이콘 표시 (↑↓)

3. **정렬 상태 관리**
   - 선택한 정렬 기준이 URL에 반영
   - 페이지 새로고침 시 정렬 상태 유지
   - 정렬 변경 시 첫 페이지로 이동

4. **성능 최적화**
   - 데이터베이스 인덱스 활용
   - 정렬 쿼리 최적화
   - 정렬 변경 시 빠른 응답

5. **사용자 경험**
   - 정렬 변경 시 부드러운 전환
   - 로딩 상태 표시
   - 정렬 기준별 노트 수 표시

## Tasks / Subtasks

- [ ] 정렬 쿼리 최적화 (AC: 4)
  - [ ] 데이터베이스 인덱스 확인
  - [ ] 정렬 쿼리 성능 개선
  - [ ] 복합 인덱스 추가

- [ ] 정렬 Server Action 개선 (AC: 1, 4)
  - [ ] 다양한 정렬 옵션 지원
  - [ ] 정렬 파라미터 검증
  - [ ] 쿼리 성능 최적화

- [ ] 정렬 UI 컴포넌트 개선 (AC: 2, 3)
  - [ ] 정렬 옵션 확장
  - [ ] 현재 정렬 상태 표시
  - [ ] 정렬 방향 아이콘 추가

- [ ] URL 상태 관리 (AC: 3)
  - [ ] 정렬 파라미터 URL 반영
  - [ ] 페이지 새로고침 시 상태 유지
  - [ ] 정렬 변경 시 페이지 리셋

- [ ] 사용자 경험 개선 (AC: 5)
  - [ ] 정렬 변경 애니메이션
  - [ ] 로딩 상태 표시
  - [ ] 정렬 기준별 통계 표시

- [ ] 단위 테스트 작성
  - [ ] 정렬 로직 테스트
  - [ ] UI 컴포넌트 테스트
  - [ ] 성능 테스트

## Dev Notes

### 데이터 모델
- **notes 테이블**: `id`, `userId`, `title`, `content`, `createdAt`, `updatedAt`
- **정렬 필드**: `createdAt`, `updatedAt`, `title`
- **인덱스**: `userId`, `updatedAt`, `createdAt`, `title`

### API 스펙
```typescript
// Server Action (기존 getNotes 확장)
async function getNotes(params: {
  page?: number;
  limit?: number;
  sortBy?: 'createdAt' | 'updatedAt' | 'title';
  sortOrder?: 'asc' | 'desc';
}) {
  // 반환값: { success: boolean, data?: { notes, pagination, sort }, error?: string }
}
```

### 컴포넌트 구조
```
components/notes/
├── SortOptions.tsx (정렬 옵션) - 기존 확장
├── SortIndicator.tsx (정렬 상태 표시)
└── SortStats.tsx (정렬 기준별 통계)
```

### 파일 위치
- **Server Action**: `lib/actions/notes.ts` (기존 확장)
- **컴포넌트**: `components/notes/`
- **테스트**: `__tests__/notes/`

### 기술적 제약사항
- DrizzleORM을 사용한 데이터베이스 쿼리
- 기존 정렬 기능 확장
- 데이터베이스 인덱스 최적화
- shadcn/ui 컴포넌트 활용
- TypeScript 사용

### Testing
- **테스트 위치**: `__tests__/notes/`
- **테스트 프레임워크**: Jest + React Testing Library
- **테스트 범위**: 
  - 정렬 로직 테스트
  - UI 컴포넌트 테스트
  - 성능 테스트
  - URL 상태 관리 테스트

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-14 | 1.0 | 초기 스토리 생성 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### Debug Log References
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### Completion Notes List
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### File List
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

## QA Results
*이 섹션은 QA 에이전트가 검토 후에 채워집니다*



